
#📝 React Native 音声入力アプリ — 実装仕様書（リスト構成）
##🎯 目的と概要* 
**目的:** MacとWindowsで動作する高速な音声入力・文章修正アプリを開発します。
* **最重要課題:** アプリが非アクティブな状態でも機能する**グローバルショートカット**の実装（ネイティブモジュールが必要）。
* **速度重視:** LLMには処理速度が速い**GPT-5-mini**を使用します。
* **前面への表示:** 他のアプリを起動中でも常に全面に表示されるようにします


##🛠️ 必須技術スタックアプリケーションの中核となる技術構成は以下の通りです。

* **フレームワーク:** React Native (UIおよびアプリケーションロジック)
* **プラットフォーム:** `react-native-windows` および `react-native-macos`
* **マイク録音:** `react-native-audio-recorder-player` (またはネイティブモジュールで代替)
* **API通信:** `axios` または標準の `fetch` API
* **LLMサービス:** **OpenAI API**
* 文字起こし: `whisper-1`
* 文章修正: `gpt-5-mini`


* **クリップボード:** `@react-native-community/clipboard`

##✨ 機能要件と操作###1. ユーザーインターフェース (UI)* **メイン画面:**
* 録音開始/終了用の**トグルボタン**（例: マイクアイコン）。
* 文字起こし結果を表示する**「修正前テキスト」**フィールド。
* LLMによる修正後の最終結果を表示する**「最終結果」**フィールド。


* **設定:**
  * 文字起こしの**言語指定ドロップダウン**（例: 日本語、英語）。
  * APIキーの入力フィールド。
  * 前面への表示のON/OFFボタン。
  * ショートカットキーの設定フィールド。



###2. トリガー（録音開始/終了）以下のいずれかの方法で録音を開始・終了できるようにします。

* **UIボタン:** メイン画面上のトグルボタンの押下。
* **グローバルショートカット:** アプリが非アクティブな状態でもOS全体で機能するキーイベント（例: `Ctrl + Shift + S`）を押下。

---

##🚀 処理フロー（ステップ詳細）トリガーによる録音開始からクリップボードへのコピーまでの流れは、以下の6つのステップで実行されます。

###Step 1〜2. 録音とファイル化1. **ユーザーアクション**（ボタンまたはショートカット）でマイク録音を開始します。
2. 再度トリガーされると録音が停止し、音声データがOpenAIがサポートする形式（M4AやMP3など）の**一時ファイル**としてデバイスに保存されます。

###Step 3. 文字起こし (Whisper)* 保存された音声ファイルを **Whisper API** の `/v1/audio/transcriptions` エンドポイントにアップロードします。
* 設定画面で指定された言語を `language` パラメータとしてAPIリクエストに含めます。

###Step 4. 文字起こし結果の即時表示* Whisper APIから返された生の文字起こしテキストを、メイン画面の**「修正前テキスト」**フィールドに直ちに表示します。

###Step 5. LLMによる文章修正* Step 4のテキストを組み込んだプロンプト（例：「以下のテキストを自然な文法に修正してください。」）を作成します。
* これを OpenAI API の `/v1/chat/completions` エンドポイントに送信します。


###Step 6. 最終表示とクリップボードコピー* LLMから返された修正済みテキストを、**「最終結果」**フィールドに表示します。
* 同時に、`@react-native-community/clipboard`ライブラリを使用して、この修正済みテキストを**自動的にクリップボードにコピー**します。ボタンを押すことでもクリップボードにコピーできます。

##⚠️ システム連携の重要課題と解決策これらの機能は、React NativeのJavaScript層だけでは完結せず、OSレベルの操作が必要です。

###1. グローバルショートカットの実装（最重要課題）OS全体で動作するショートカットの実装には、必ず**ネイティブモジュール**の開発が必要です。

* **Windows:** **C# または C++** を用い、Win32 APIの `RegisterHotKey` などの機能でショートカットをOSに登録し、キーイベントをReact Nativeブリッジ経由でJavaScriptに通知します。
* **macOS:** **Swift または Objective-C** を用い、`NSEvent` のグローバルモニター機能でキーイベントを捕捉し、同様にReact Nativeブリッジへ通知します。

###2. APIキーのセキュリティ* **厳禁:** APIキーをReact Nativeのコード内に直接記述することは避けてください。
設定画面にてユーザーがAPIキーを入力し、アプリ内で使用します。

###3. マイクアクセス権限* アプリの初回起動時、または初回録音時に、OSからマイクアクセスの**権限許可**をユーザーに求める必要があります。